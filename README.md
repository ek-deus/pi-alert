# pi.alert

1. sudo docker-compose up -d
2. sudo docker-compose --env-file /path/to/.env up
3. 


#üìï –û—Å–Ω–æ–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–í–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ —Å–µ—Ç–∏ —Ö–æ—Å—Ç–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä: `sudo docker run --rm --net=host jokobsk/pi.alert`
–ù–∞—á–∞–ª—å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –¥–æ 15 –º–∏–Ω—É—Ç (—Å 50 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –∏ MQTT). –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ 3 –∏ 5 –º–∏–Ω—É—Ç, —Ç–∞–∫ —á—Ç–æ –ø–æ–¥–æ–∂–¥–∏—Ç–µ —Å—Ç–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏, –ø–æ–∫–∞ –Ω–µ –±—É–¥—É—Ç –∑–∞–ø—É—â–µ–Ω—ã –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.

#–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã Docker

|–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è	|–û–ø–∏—Å–∞–Ω–∏–µ| |–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é|
|PORT	|–ü–æ—Ä—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞|	|20211|
|TZ|	|–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏. –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–π —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –∑–¥–µ—Å—å|	|Europe/Berlin|
|HOST_USER_GID|	|–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (UID) –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å–µ—Ä–≤–µ—Ä–∞ —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏ –Ω–∞ —á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å –≤ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö|	|1000|
|HOST_USER_ID|	|–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (GID) –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —Å –≥—Ä—É–ø–ø–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–µ—Ä–≤–µ—Ä–∞ —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏ –Ω–∞ —á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.|	|1000|

#–ü—É—Ç–∏ –∫ Docker

|| |–ü—É—Ç—å|	|–û–ø–∏—Å–∞–Ω–∏–µ|
|–¢—Ä–µ–±—É–µ—Ç—Å—è	|:/home/pi/pialert/config|	|–ü–∞–ø–∫–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è pialert.conf—Ñ–∞–π–ª (–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Å–º. –ù–∏–∂–µ)|
|–¢—Ä–µ–±—É–µ—Ç—Å—è	|:/home/pi/pialert/db|	|–ü–∞–ø–∫–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è pialert.db—Ñ–∞–π–ª|
|–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ|	|:/home/pi/pialert/db/setting_darkmode	–°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç–æ–π —Ñ–∞–π–ª —Å –∏–º–µ–Ω–µ–ºsetting_darkmode, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤–∫–ª—é—á–∏—Ç—å —Ç–µ–º–Ω—ã–π —Ä–µ–∂–∏–º –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞|
|–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ|	|:/home/pi/pialert/front/log|	|–ü–∞–ø–∫–∞ –∂—É—Ä–Ω–∞–ª–æ–≤ –ø–æ–ª–µ–∑–Ω–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏, –µ—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞|
|–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ|	|:/etc/pihole/pihole-FTL.db|	|–§–∞–π–ª pihole-FTL.db–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PiHole. –¢—Ä–µ–±—É–µ—Ç—Å—è, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PiHole|
|–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ|	|:/etc/pihole/dhcp.leases	dhcp.leases| |–î–æ—Å—å–µ –ü–∏–•–æ–ª–∞. –¢—Ä–µ–±—É–µ—Ç—Å—è, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PiHole|

#–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (pialert.conf)

–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª pialert.conf –æ—Ç—Å—é–¥–∞.
‚ùó –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ SCAN_SUBNETS–ø–µ—Ä–µ–º–µ–Ω–Ω—É—é.
–ê–¥–∞–ø—Ç–µ—Ä , –≤–µ—Ä–æ—è—Ç–Ω–æ , –±—É–¥–µ—Ç eth0–∏–ª–∏ eth1. (–ó–∞–ø—É—Å—Ç–∏—Ç–µiwconfig, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∏–º—è (—ã) –≤–∞—à–µ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞).
–£–∫–∞–∂–∏—Ç–µ —Å–µ—Ç–µ–≤–æ–π —Ñ–∏–ª—å—Ç—Ä (–∫–æ—Ç–æ—Ä—ã–π –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è). –ù–∞–ø—Ä–∏–º–µ—Ä, —Ñ–∏–ª—å—Ç—Ä 192.168.1.0/24–æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω—ã IP-–∞–¥—Ä–µ—Å–æ–≤ –æ—Ç 192.168.1.0 –¥–æ 192.168.1.255.
–ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –æ–¥–Ω–æ–π –∏ –¥–≤—É—Ö –ø–æ–¥—Å–µ—Ç–µ–π (‚ùó –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ ['...', '...']—Ñ–æ—Ä–º–∞—Ç –¥–ª—è –¥–≤—É—Ö –∏–ª–∏ –±–æ–ª–µ–µ –ø–æ–¥—Å–µ—Ç–µ–π):
–û–¥–Ω–∞ –ø–æ–¥—Å–µ—Ç—å: SCAN_SUBNETS = '192.168.1.0/24 --interface=eth0'
–î–≤–µ –ø–æ–¥—Å–µ—Ç–∏: SCAN_SUBNETS = ['192.168.1.0/24 --interface=eth0', '192.168.1.0/24 --interface=eth1']
–ó–∞–¥–∞–π—Ç–µ —Å–≤–æ–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç—á–µ—Ç–æ–≤.
–Ø —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –Ω–æ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤—ã –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.
üõë –û–±—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
üí° –ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–π –ø—Ä–æ–±–ª–µ–º—ã, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, –±—ã–ª–∞ –ª–∏ —É–∂–µ —Ä–µ—à–µ–Ω–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞.

#–†–∞–∑—Ä–µ—à–µ–Ω–∏—è

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º (–æ—à–∏–±–∫–∏ AJAX, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –ø—É—Å—Ç–æ–π —ç–∫—Ä–∞–Ω –∏ —Ç. –î.) –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∂—É—Ä–Ω–∞–ª—ã –≤ —Ä–∞–∑–¥–µ–ª–µ/home/pi/pialert/front/log.
–ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏, –≤—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ë–î, –∞ –∑–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î —á–µ—Ä–µ–∑ —Ä–∞–∑–¥–µ–ª –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ> –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ / –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ.
–í—ã –º–æ–∂–µ—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ç–∞–∫–∂–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∏ –≥—Ä—É–ø–ø—Épialert.db, –≤—ã–ø–æ–ª–Ω–∏–≤ —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ —Ö–æ—Å—Ç-—Å–∏—Å—Ç–µ–º–µ: docker exec pialert chown -R www-data:www-data /home/pi/pialert/db/pialert.db.
–°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø. –£–∫–∞–∂–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã HOST_USER_ID–∏HOST_USER_GID, –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ.
–°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ —Ñ–∞–π–ª `pialert.db (‚ö† –Ω–µ –ø–∞–ø–∫—É) `—Å :/home/pi/pialert/db/pialert.db`(–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Å–º. –í –ø—Ä–∏–º–µ—Ä–∞—Ö –Ω–∏–∂–µ)
–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ / —Å–±–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∂—É—Ä–Ω–∞–ª—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ß–∞—Å—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –º–µ—Ç–æ–¥–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.
–Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑—Ä–µ—à–∏—Ç—å —É–∑–µ–ª

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à–∞ SCAN_SUBNETS–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –º–∞—Å–∫—É, --interface–∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã—Ö –≤—ã—à–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è—Ö.
–ü—Ä–∏–º–µ—Ä—ã —Å–æ–∑–¥–∞–Ω–∏—è Docker-compose –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∏–∂–µ.

#üìÑ –ü—Ä–∏–º–µ—Ä—ã

```yml
version: "3"
services:
  pialert:
    container_name: pialert
    image: "jokobsk/pi.alert:latest"      
    network_mode: "host"        
    restart: unless-stopped
    volumes:
      - local/path/pialert/config:/home/pi/pialert/config
      - local/path/pialert/db:/home/pi/pialert/db
      # (optional) map an empty file with the name 'setting_darkmode' if you want to force the dark mode on container rebuilt
      - local/path/pialert/db/setting_darkmode:/home/pi/pialert/db/setting_darkmode
      # (optional) useful for debugging if you have issues setting up the container
      - local/path/logs:/home/pi/pialert/front/log
    environment:
      - TZ=Europe/Berlin      
      - HOST_USER_ID=1000
      - HOST_USER_GID=1000
      - PORT=20211
 ```     
–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: `sudo docker-compose up -d`

–ü—Ä–∏–º–µ—Ä 2
docker-compose.yml

```yml
version: "3"
services:
  pialert:
    container_name: pialert
    image: "jokobsk/pi.alert:latest"      
    network_mode: "host"        
    restart: unless-stopped
    volumes:
      - ${APP_DATA_LOCATION}/pialert/config:/home/pi/pialert/config
      - ${APP_DATA_LOCATION}/pialert/db/pialert.db:/home/pi/pialert/db/pialert.db
      # (optional) map an empty file with the name 'setting_darkmode' if you want to force the dark mode on container rebuilt
      - ${APP_DATA_LOCATION}/pialert/db/setting_darkmode:/home/pi/pialert/db/setting_darkmode
      # (optional) useful for debugging if you have issues setting up the container
      - ${LOGS_LOCATION}:/home/pi/pialert/front/log
    environment:
      - TZ=${TZ}      
      - HOST_USER_ID=${HOST_USER_ID}
      - HOST_USER_GID=${HOST_USER_GID}
      - PORT=${PORT}
```      
.env —Ñ–∞–π–ª

```.env
#GLOBAL PATH VARIABLES

APP_DATA_LOCATION=/path/to/docker_appdata
APP_CONFIG_LOCATION=/path/to/docker_config
LOGS_LOCATION=/path/to/docker_logs

#ENVIRONMENT VARIABLES

TZ=Europe/Paris
HOST_USER_ID=1000
HOST_USER_GID=1000
PORT=20211

#DEVELOPMENT VARIABLES

DEV_LOCATION=/path/to/local/source/code
```

–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: `sudo docker-compose --env-file /path/to/.env up`

–ü—Ä–∏–º–µ—Ä 3
–õ—é–±–µ–∑–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ pbek. –¢–æ–º pialert_db–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞—Ç–∞–ª–æ–≥–æ–º –ë–î. –î–≤–∞ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–∏ –Ω–∞ —Å–≤–æ–∏ –º–µ—Å—Ç–∞ –≤ –ø–∞–ø–∫–µ config. –í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é docker-compose.yaml–∫–æ–ø–∏—é –ø–∞–ø–∫–∏ –∏ –ø–∞–ø–∫–∏ docker volumes.

  ```yml
  pialert:
    image: jokobsk/pi.alert
    ports:
      - "80:20211/tcp"
    environment:
      - TZ=Europe/Vienna
    networks:
      local:
        ipv4_address: 192.168.1.2
    restart: unless-stopped
    volumes:
      - pialert_db:/home/pi/pialert/db
      - ./pialert/pialert.conf:/home/pi/pialert/config/pialert.conf
```

